YUI.add("anim-base",function(e,t){var n="running",r="startTime",i="elapsedTime",s="start",o="tween",u="end",a="node",f="paused",l="reverse",c="iterationCount",h=Number,p={},d;e.Anim=function(){e.Anim.superclass.constructor.apply(this,arguments),e.Anim._instances[e.stamp(this)]=this},e.Anim.NAME="anim",e.Anim._instances={},e.Anim.RE_DEFAULT_UNIT=/^width|height|top|right|bottom|left|margin.*|padding.*|border.*$/i,e.Anim.DEFAULT_UNIT="px",e.Anim.DEFAULT_EASING=function(e,t,n,r){return n*e/r+t},e.Anim._intervalTime=20,e.Anim.behaviors={left:{get:function(e,t){return e._getOffset(t)}}},e.Anim.behaviors.top=e.Anim.behaviors.left,e.Anim.DEFAULT_SETTER=function(t,n,r,i,s,o,u,a){var f=t._node,l=f._node,c=u(s,h(r),h(i)-h(r),o);l?"style"in l&&(n in l.style||n in e.DOM.CUSTOM_STYLES)?(a=a||"",f.setStyle(n,c+a)):"attributes"in l&&n in l.attributes?f.setAttribute(n,c):n in l&&(l[n]=c):f.set?f.set(n,c):n in f&&(f[n]=c)},e.Anim.DEFAULT_GETTER=function(t,n){var r=t._node,i=r._node,s="";return i?"style"in i&&(n in i.style||n in e.DOM.CUSTOM_STYLES)?s=r.getComputedStyle(n):"attributes"in i&&n in i.attributes?s=r.getAttribute(n):n in i&&(s=i[n]):r.get?s=r.get(n):n in r&&(s=r[n]),s},e.Anim.ATTRS={node:{setter:function(t){return t&&(typeof t=="string"||t.nodeType)&&(t=e.one(t)),this._node=t,!t,t}},duration:{value:1},easing:{value:e.Anim.DEFAULT_EASING,setter:function(t){if(typeof t=="string"&&e.Easing)return e.Easing[t]}},from:{},to:{},startTime:{value:0,readOnly:!0},elapsedTime:{value:0,readOnly:!0},running:{getter:function(){return!!p[e.stamp(this)]},value:!1,readOnly:!0},iterations:{value:1},iterationCount:{value:0,readOnly:!0},direction:{value:"normal"},paused:{readOnly:!0,value:!1},reverse:{value:!1}},e.Anim.run=function(){var t=e.Anim._instances,n;for(n in t)t[n].run&&t[n].run()},e.Anim.pause=function(){for(var t in p)p[t].pause&&p[t].pause();e.Anim._stopTimer()},e.Anim.stop=function(){for(var t in p)p[t].stop&&p[t].stop();e.Anim._stopTimer()},e.Anim._startTimer=function(){d||(d=setInterval(e.Anim._runFrame,e.Anim._intervalTime))},e.Anim._stopTimer=function(){clearInterval(d),d=0},e.Anim._runFrame=function(){var t=!0,n;for(n in p)p[n]._runFrame&&(t=!1,p[n]._runFrame());t&&e.Anim._stopTimer()},e.Anim.RE_UNITS=/^(-?\d*\.?\d*){1}(em|ex|px|in|cm|mm|pt|pc|%)*$/;var v={run:function(){return this.get(f)?this._resume():this.get(n)||this._start(),this},pause:function(){return this.get(n)&&this._pause(),this},stop:function(e){return(this.get(n)||this.get(f))&&this._end(e),this},_added:!1,_start:function(){this._set(r,new Date-this.get(i)),this._actualFrames=0,this.get(f)||this._initAnimAttr(),p[e.stamp(this)]=this,e.Anim._startTimer(),this.fire(s)},_pause:function(){this._set(r,null),this._set(f,!0),delete p[e.stamp(this)],this.fire("pause")},_resume:function(){this._set(f,!1),p[e.stamp(this)]=this,this._set(r,new Date-this.get(i)),e.Anim._startTimer(),this.fire("resume")},_end:function(t){var n=this.get("duration")*1e3;t&&this._runAttrs(n,n,this.get(l)),this._set(r,null),this._set(i,0),this._set(f,!1),delete p[e.stamp(this)],this.fire(u,{elapsed:this.get(i)})},_runFrame:function(){var e=this._runtimeAttr.duration,t=new Date-this.get(r),n=this.get(l),s=t>=e;this._runAttrs(t,e,n),this._actualFrames+=1,this._set(i,t),this.fire(o),s&&this._lastFrame()},_runAttrs:function(t,n,r){var i=this._runtimeAttr,s=e.Anim.behaviors,o=i.easing,u=n,a=!1,f,l,c;t>=n&&(a=!0),r&&(t=n-t,u=0);for(c in i)i[c].to&&(f=i[c],l=c in s&&"set"in s[c]?s[c].set:e.Anim.DEFAULT_SETTER,a?l(this,c,f.from,f.to,u,n,o,f.unit):l(this,c,f.from,f.to,t,n,o,f.unit))},_lastFrame:function(){var e=this.get("iterations"),t=this.get(c);t+=1,e==="infinite"||t<e?(this.get("direction")==="alternate"&&this.set(l,!this.get(l)),this.fire("iteration")):(t=0,this._end()),this._set(r,new Date),this._set(c,t)},_initAnimAttr:function(){var t=this.get("from")||{},n=this.get("to")||{},r={duration:this.get("duration")*1e3,easing:this.get("easing")},i=e.Anim.behaviors,s=this.get(a),o,u,f;e.each(n,function(n,a){typeof n=="function"&&(n=n.call(this,s)),u=t[a],u===undefined?u=a in i&&"get"in i[a]?i[a].get(this,a):e.Anim.DEFAULT_GETTER(this,a):typeof u=="function"&&(u=u.call(this,s));var l=e.Anim.RE_UNITS.exec(u),c=e.Anim.RE_UNITS.exec(n);u=l?l[1]:u,f=c?c[1]:n,o=c?c[2]:l?l[2]:"",!o&&e.Anim.RE_DEFAULT_UNIT.test(a)&&(o=e.Anim.DEFAULT_UNIT);if(!u||!f){e.error('invalid "from" or "to" for "'+a+'"',"Anim");return}r[a]={from:e.Lang.isObject(u)?e.clone(u):u,to:f,unit:o}},this),this._runtimeAttr=r},_getOffset:function(e){var t=this._node,n=t.getComputedStyle(e),r=e==="left"?"getX":"getY",i=e==="left"?"setX":"setY",s;return n==="auto"&&(s=t.getStyle("position"),s==="absolute"||s==="fixed"?(n=t[r](),t[i](n)):n=0),n},destructor:function(){delete e.Anim._instances[e.stamp(this)]}};e.extend(e.Anim,e.Base,v)},"3.16.0",{requires:["base-base","node-style"]});
YUI.add("anim-color",function(e,t){var n=Number;e.Anim.getUpdatedColorValue=function(t,r,i,s,o){return t=e.Color.re_RGB.exec(e.Color.toRGB(t)),r=e.Color.re_RGB.exec(e.Color.toRGB(r)),(!t||t.length<3||!r||r.length<3)&&e.error("invalid from or to passed to color behavior"),"rgb("+[Math.floor(o(i,n(t[1]),n(r[1])-n(t[1]),s)),Math.floor(o(i,n(t[2]),n(r[2])-n(t[2]),s)),Math.floor(o(i,n(t[3]),n(r[3])-n(t[3]),s))].join(", ")+")"},e.Anim.behaviors.color={set:function(t,n,r,i,s,o,u){t._node.setStyle(n,e.Anim.getUpdatedColorValue(r,i,s,o,u))},get:function(e,t){var n=e._node.getComputedStyle(t);return n=n==="transparent"?"rgb(255, 255, 255)":n,n}},e.each(["backgroundColor","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor"],function(t){e.Anim.behaviors[t]=e.Anim.behaviors.color})},"3.16.0",{requires:["anim-base"]});
YUI.add("anim-xy",function(e,t){var n=Number;e.Anim.behaviors.xy={set:function(e,t,r,i,s,o,u){e._node.setXY([u(s,n(r[0]),n(i[0])-n(r[0]),o),u(s,n(r[1]),n(i[1])-n(r[1]),o)])},get:function(e){return e._node.getXY()}}},"3.16.0",{requires:["anim-base","node-screen"]});
YUI.add("anim-curve",function(e,t){e.Anim.behaviors.curve={set:function(t,n,r,i,s,o,u){r=r.slice.call(r),i=i.slice.call(i);var a=u(s,0,100,o)/100;i.unshift(r),t._node.setXY(e.Anim.getBezier(i,a))},get:function(e){return e._node.getXY()}},e.Anim.getBezier=function(e,t){var n=e.length,r=[],i,s;for(i=0;i<n;++i)r[i]=[e[i][0],e[i][1]];for(s=1;s<n;++s)for(i=0;i<n-s;++i)r[i][0]=(1-t)*r[i][0]+t*r[parseInt(i+1,10)][0],r[i][1]=(1-t)*r[i][1]+t*r[parseInt(i+1,10)][1];return[r[0][0],r[0][1]]}},"3.16.0",{requires:["anim-xy"]});
YUI.add("anim-easing",function(e,t){var n={easeNone:function(e,t,n,r){return n*e/r+t},easeIn:function(e,t,n,r){return n*(e/=r)*e+t},easeOut:function(e,t,n,r){return-n*(e/=r)*(e-2)+t},easeBoth:function(e,t,n,r){return(e/=r/2)<1?n/2*e*e+t:-n/2*(--e*(e-2)-1)+t},easeInStrong:function(e,t,n,r){return n*(e/=r)*e*e*e+t},easeOutStrong:function(e,t,n,r){return-n*((e=e/r-1)*e*e*e-1)+t},easeBothStrong:function(e,t,n,r){return(e/=r/2)<1?n/2*e*e*e*e+t:-n/2*((e-=2)*e*e*e-2)+t},elasticIn:function(e,t,n,r,i,s){var o;return e===0?t:(e/=r)===1?t+n:(s||(s=r*.3),!i||i<Math.abs(n)?(i=n,o=s/4):o=s/(2*Math.PI)*Math.asin(n/i),-(i*Math.pow(2,10*(e-=1))*Math.sin((e*r-o)*2*Math.PI/s))+t)},elasticOut:function(e,t,n,r,i,s){var o;return e===0?t:(e/=r)===1?t+n:(s||(s=r*.3),!i||i<Math.abs(n)?(i=n,o=s/4):o=s/(2*Math.PI)*Math.asin(n/i),i*Math.pow(2,-10*e)*Math.sin((e*r-o)*2*Math.PI/s)+n+t)},elasticBoth:function(e,t,n,r,i,s){var o;return e===0?t:(e/=r/2)===2?t+n:(s||(s=r*.3*1.5),!i||i<Math.abs(n)?(i=n,o=s/4):o=s/(2*Math.PI)*Math.asin(n/i),e<1?-0.5*i*Math.pow(2,10*(e-=1))*Math.sin((e*r-o)*2*Math.PI/s)+t:i*Math.pow(2,-10*(e-=1))*Math.sin((e*r-o)*2*Math.PI/s)*.5+n+t)},backIn:function(e,t,n,r,i){return i===undefined&&(i=1.70158),e===r&&(e-=.001),n*(e/=r)*e*((i+1)*e-i)+t},backOut:function(e,t,n,r,i){return typeof i=="undefined"&&(i=1.70158),n*((e=e/r-1)*e*((i+1)*e+i)+1)+t},backBoth:function(e,t,n,r,i){return typeof i=="undefined"&&(i=1.70158),(e/=r/2)<1?n/2*e*e*(((i*=1.525)+1)*e-i)+t:n/2*((e-=2)*e*(((i*=1.525)+1)*e+i)+2)+t},bounceIn:function(t,n,r,i){return r-e.Easing.bounceOut(i-t,0,r,i)+n},bounceOut:function(e,t,n,r){return(e/=r)<1/2.75?n*7.5625*e*e+t:e<2/2.75?n*(7.5625*(e-=1.5/2.75)*e+.75)+t:e<2.5/2.75?n*(7.5625*(e-=2.25/2.75)*e+.9375)+t:n*(7.5625*(e-=2.625/2.75)*e+.984375)+t},bounceBoth:function(t,n,r,i){return t<i/2?e.Easing.bounceIn(t*2,0,r,i)*.5+n:e.Easing.bounceOut(t*2-i,0,r,i)*.5+r*.5+n}};e.Easing=n},"3.16.0",{requires:["anim-base"]});
YUI.add("anim-node-plugin",function(e,t){var n=function(t){t=t?e.merge(t):{},t.node=t.host,n.superclass.constructor.apply(this,arguments)};n.NAME="nodefx",n.NS="fx",e.extend(n,e.Anim),e.namespace("Plugin"),e.Plugin.NodeFX=n},"3.16.0",{requires:["node-pluginhost","anim-base"]});
YUI.add("anim-scroll",function(e,t){var n=Number;e.Anim.behaviors.scroll={set:function(e,t,r,i,s,o,u){var a=e._node,f=[u(s,n(r[0]),n(i[0])-n(r[0]),o),u(s,n(r[1]),n(i[1])-n(r[1]),o)];f[0]&&a.set("scrollLeft",f[0]),f[1]&&a.set("scrollTop",f[1])},get:function(e){var t=e._node;return[t.get("scrollLeft"),t.get("scrollTop")]}}},"3.16.0",{requires:["anim-base"]});
YUI.add("anchor-repositioner",function(n,e){require("hermes-core/flog")(e);var o=10;n.AnchorRepositioner=(function(){function e(n,e){l.push({key:n,y:e})}function i(){var e,o=n.config.win.location.hash.replace("#","");o&&(e=n.one('[id="'+o+'"], [name="'+o+'"]'))&&t(e)}function t(e){e instanceof n.Node||(e=n.one(e)),a=e}function r(e){var o,i,r;e&&t(e),a&&(a.scrollIntoView(!0),o=n.config.win.scrollY||n.config.win.pageYOffset,i=Math.ceil(a.getY()),r=l.reduce(function(n,e){return n+e.y},0),i>=o&&i<=o+r&&(s&&s.stop(),(s=new n.Anim({duration:.25,node:"win",easing:"easeOut",to:{scroll:[0,i-r]}})).on("end",function(n){s=null}),s.run()))}function c(o,i){i instanceof n.Node&&e(o,parseInt(i.getComputedStyle("height"),10))}function f(n){return l.some(function(e,o){if(e.key===n)return l.splice(o,1),!0})}var u,a,s,l=[];return u||(i(),e("default",o),n.on("hashchange",function(n){i(),r()},n.config.win),u={addOffset:c,removeOffset:f,jumpTo:r}),u})()},"@VERSION@",{requires:["node","anim"]});YUI.add("atics",function(e,n){e.Analytics=(function(){function n(){return document.querySelectorAll("script[src*=adobedtm\\.com]").length<2||!window.s}function a(e){s=e=void 0===e||e,n()&&(s=!1),l("Adobe Analytics enabled: "+s)}function t(e){l("Debugging logging enabled: "+(u=e=void 0===e||e))}function i(e,n){n=n||"CTA Link Clicked",window.appEventData.push({linkInfo:{linkId:e},event:n})}function o(e){if(!n())try{e=e||window.appContext.flapp.get("activeView").name,s&&(!(function(e,n){var a,t={bubbles:!0,cancelable:!0,detail:n};document.createEvent&&document.body.dispatchEvent?((a=document.createEvent("CustomEvent")).initCustomEvent(e,t.bubbles,t.cancelable,t.detail),document.body.dispatchEvent(a)):window.CustomEvent&&document.body.dispatchEvent&&(a=new CustomEvent(e,t),document.body.dispatchEvent(a))})("sendPageView",window.dataLayer),l("Adobe Analytics PageView: "+e+", "+document.location.pathname))}catch(e){l(e)}}function r(){var n=window.appContext.flapp.get("activeView");l("learning"),window.dataLayer={page:{pageInfo:{pageID:"",pageName:"",destinationURL:"",referringURL:"",onsiteSearchTerm:"",language:"",country:"",geoRegion:"",author:"",pageType:""}},product:[],events:[],cart:{},transaction:{transactionID:"",total:{basePrice:0,voucherCode:"",voucherDiscount:0,currency:"",taxRate:0,shipping:0,shippingMethod:"",priceWithTax:0,transactionTotal:0,item:[]}},user:{profile:{profileInfo:{profileID:"",userName:"",language:"",intl:"",signedIn:""},address:"",social:{facebook:"",facebookInfo:"",twitter:"",twitterInfo:""},segment:{isNewRegistration:null,isUserNewCustomer:null,isLoggedIn:null,customerClassDimension:"",visitorLifetimeValue:0}}}};try{var a=window.appContext&&window.appContext.getViewer?window.appContext.getViewer():null;a&&(a.signedIn?(window.dataLayer.user.profile.profileInfo.signedIn="signedIn",window.dataLayer.user.profile.profileInfo.profileID=a.nsid,window.dataLayer.user.profile.profileInfo.intl=a.intl,window.dataLayer.user.profile.segment.customerClassDimension=a.isPro?"pro":"free"):window.dataLayer.user.profile.profileInfo.signedIn="signedOut"),window.navigator&&window.navigator.language&&(window.dataLayer.user.profile.profileInfo.language=window.navigator.language),window.dataLayer.page.pageInfo.pageID=e.murmurhash(document.title,document.title+" insecure hawaiian volcano salt"),window.dataLayer.page.pageInfo.pageName=n.name,window.dataLayer.page.pageInfo.destinationURL=document.location.href}catch(e){l("learn() blew up.",e)}}function d(n,a){e.Object.setValue(window.dataLayer,n.split("."),a)}function l(e,n){u&&console.info("[Analytics] ",e,n)}var c,s=!1,u=!1;return c||(window.appEventData=window.appEventData||[],e.one("body").delegate("click",function(e){i(e.target.ancestor("[data-link-id]",!0).getAttribute("data-link-id"))},"a[data-link-id]"),c={sendPageView:o,sendClick:i,enableAdobeAnalytics:a,enableDebugging:t,learn:r,setDataLayerProp:d}),c})()},"@VERSION@",{requires:["murmurhash"],affinity:"client"});YUI.add("client-app",function(e,i){function n(){y=!1}function t(i){var n,t,r=window.location,a=window.history,o=!1;if(r.search&&a.replaceState&&(n=e.QueryString.parse(r.search.replace("?","")),i.forEach(function(e){e in n&&(delete n[e],o=!0)}),o)){t=e.QueryString.stringify(n);try{a.replaceState({},"",r.pathname+(t?"?"+t:""))}catch(e){}}}function r(e,i){return i.betterUse(e,i)}function a(i){var n,t,r,a,o=[],s=["flickr.photos.addView","flickr.groups.updateViewDate","flickr.photos.getPhotos","flickr.people.addView","flickr.photosets.addView"];if(w.getViewCounter().flushQueue(),w.uploadIsInProgress())a=this.intlMessage({intlName:"client-app.UPLOAD_IN_PROGRESS"});else{for(n in w.writeAPICallsMadeOnThisPage)(t=w.writeAPICallsMadeOnThisPage[n]).completed||o.push(t);o.length&&(o.every(function(e){return-1!==s.indexOf(e.methodName)})||(e.config.flickr.requestConfig&&e.config.flickr.requestConfig.auth&&e.config.flickr.requestConfig.auth.isInsecureGod?(r=o.map(function(e){return e.methodName}).join(", "),a=this.intlMessage({intlName:"client-app.SAVING_LAST_ACTIONS"})+" In progress API Methods: "+r):a=this.intlMessage({intlName:"client-app.SAVING_LAST_ACTIONS"})))}return e.Storage.Instance.clear(),a&&((i||window.event).returnValue=a),a}function o(i){if(!y)return window.location=i.url,void i.halt();w.setClientSideRouted(!0),w.setPreviousLocation(),w.updateModelRefetchState(i.url,i.originEvent&&i.originEvent.currentTarget&&i.originEvent.currentTarget.hasClass("do-not-evict")),w.clearWriteAPICallCache(),w.setGPCredentials(null),e.loaderBar.start(),w.adManager.isEnabled()&&w.adManager.currentlyShowingAd&&w.adManager.adIsUnloading(),w.getKeyboardManager().resetCurrentKeyEventScope(),e.Object.each(w.modelRegistries,function(e,i){e.hasWeakSubscribers&&e.removeWeakSubscribers()}),v=!0}function s(){e.UA.chrome>0&&(window.scrollTo(window.scrollX,window.scrollY+1),window.scrollTo(window.scrollX,window.scrollY-1))}function c(i){e.Object.each(w.modelRegistries,function(e,i){e.hasWeakSubscribers&&e.removeWeakSubscribers()}),e.fire("close-dialogs"),"popstate"===i.src&&s(),"popstate"!==i.src||h.hasRoute(h.getPath())||e.Object.isEmpty(i.newVal)||h.navigate(h.getPath()),w.getViewCounter().flushQueue({resetDuplicateTracking:!0}),v||w.updateModelRefetchState(),v=!1}function l(e){h.set("previousView",e.prevVal)}function u(i,n){n=n||h.get("activeView"),e.rapidTracker.getConf(n,w,i).then(function(i){e.rapidTracker.init(i)})}function d(i,n){e.rapidTracker&&e.rapidTracker.destroy&&e.rapidTracker.destroy(),u(i,n)}function f(i){var n=this.get("activeView");if(void 0===n.getViewDataFromHistory("referrer")&&n.setViewDataOnHistory("referrer",w.getPreviousURL()),d(),e.Analytics&&(e.Analytics.learn(),n.updateDataLayer(),e.Analytics.sendPageView()),e.DeferImages.update(),w.adManager.setAdCouldBeShown(!1),e.config.win.onappclientnav)try{e.config.win.onappclientnav()}catch(i){}e.Accessibility.manageFocusOutlines(n),e.rapidTracker.beaconScroll(n),void 0!==window._sift&&window._sift.push&&window._sift.push(["_trackPageview"])}function p(i){return new e.Promise(function(n,r){var a=setTimeout(function(){r(new Error("Initial View Timeout"))},1e4);i.params.appContext=w,h.showContent(e.one("#content > .view"),{view:{name:i.name,config:i.params}},function(i){e.one("body").removeClass("dark-loader"),i._params&&(i._params.keyEventScope=i.name+i._yuid),i.setViewDataOnHistory("referrer",document.referrer),i.set("isRootView",!0),i.initialize().then(function(){u(),e.Analytics&&(e.Analytics.learn(),e.Analytics.enableAdobeAnalytics(window.appContext.flipper.isFlipped("enable-adobe-analytics")),i.updateDataLayer(),e.Analytics.sendPageView()),w.getKeyboardManager().setCurrentKeyEventScope(i.name+i._yuid),s(),e.DeferImages.init(),e.Accessibility.manageFocusOutlines(i),e.rapidTracker.beaconScroll(i),t(["campaignID","linkID"]),(function(){if(e.config.flickr.requestConfig&&e.config.flickr.requestConfig.auth&&e.config.flickr.requestConfig.auth.isInsecureGod){var i=e.all("[data-view-signature]");i.size()&&m.warn("View signature mismatches detected! A view likely modified the `params` object directly.",{views:i.getDOMNodes()})}})(),clearTimeout(a),n()}).then(null,function(e){throw m.error("There was a problem initializing or activating the view.",{err:e}),r(),e})}),h.before("navigate",o),h.before("activeViewChange",l),e.on("history:change",c),h.after("activeViewChange",f)})}function g(i,n,t,r){var a={};return e.Views&&e.Views[i]&&(a[i]={type:e.Views[i],preserve:!1}),h=new e.App({serverRouting:!0,viewContainer:"#content",container:"#content",linkSelector:":not(.server-only-link):not([target=_blank])",scrollToTop:!1,views:a}),new e.FlickrRouter(h,e.config.flickr.routes),r.auth=n,r.flapp=h,w=(function(i){return window.appContext=new e.AppContext(i),window.appContext})(r),w.routeTiming=r.routeTiming,w.routeConfig=r.routeConfig,e.mix(e.Node.DOM_EVENTS,{transitionend:!0,webkitTransitionEnd:!0}),e.ClientTransport.authorize(w),window.addEventListener("unload",function(i){e.ClientTransport.unloading=!0}),window.addEventListener("load",function(i){e.ClientTransport.unloading=!1}),w.modelImportExport.importAll(t)}var w,h,m=require("hermes-core/flog")(i),v=!1,y=e.config.flickr.clientNavEnabled;e.ClientApp={init:function(i){if(void 0===i)return e.Promise.reject({message:"Invalid config object supplied, was undefined."});var o,s,c=i.initialView,l=i.modelExport,u=i.auth,d=this;return u||n(),o=u&&i.auth.signedIn?i.auth.csrf:null,e.config.flickr.csrf.token=o,e.config.flickr.requestConfig={auth:u},i.params.routeTiming=i.routeTiming,i.params.routeConfig=i.routeConfig,t(e.config.flickr.routing_params),window.location.search&&window.location.search.match(/yc=/)&&(s=e.QueryString.parse(window.location.search.replace("?","")),e.config.flickr.ycParam=s.yc),e.transportFactory=function(i,n){return new e.ClientTransport(n)},r(c.name,e).then(function(){return g(c.name,u,l,i.params)}).then(function(){return p(c)}).then(function(){!(function(){var i=e.one("link#rollup-css");i?i.get("sheet")?(w.isCSSLoaded=!0,e.fire("css-loaded")):i.once("load",function(){w.isCSSLoaded=!0,e.fire("css-loaded")}):(w.isCSSLoaded=!0,e.fire("css-loaded"))})(),e.AnchorRepositioner.jumpTo(),e.config.win.addEventListener("beforeunload",a.bind(d))}).then(e.config.win.onappinit)},beforeUnload:a,beforeNavigate:o,_loadInitialView:r,langBundles:["client-app"],updateRapidTracker:d,disableClientNav:n},e.mix(e.ClientApp,e.Localizable)},"@VERSION@",{requires:["app-base","app-content","router","app-context","client-transport","flickr-router","handlebars-helpers","loader-bar","murmurhash","node","rapid","site-key","better-use","flickr-promise","global-events","querystring-parse-simple","querystring-stringify-simple","storage-helper","keyboard-manager","dom","overflow-helper","defer-images","accessibility","anchor-repositioner","atics"],affinity:"client",langBundles:["client-app"]});YUI.add("csrf-updater",function(t){"use strict";var e=require("hermes-core/flog")("csrf");t.CsrfUpdater=function(t){this.flickrAPI=t,this._tasks=[]},t.CsrfUpdater.prototype.getKey=function(){return t.config.flickr.csrf.token||null},t.CsrfUpdater.prototype.isExpired=function(){return!!t.config.flickr.csrf.token&&Date.now()/1e3>t.config.flickr.csrf.csrfExpiresAt},t.CsrfUpdater.prototype.invalidate=function(t){var e=this._lastStored||0;if(t||(t=0),!(t<e))return this.setExpired()},t.CsrfUpdater.prototype.setExpired=function(){return t.config.flickr.csrf.csrfExpiresAt=0},t.CsrfUpdater.prototype.store=function(e,r){this._lastStored=Date.now(),r||(r=Math.floor(this._lastStored/1e3)),t.config.flickr.csrf.token=e,t.config.flickr.csrf.csrfFetched=r,t.config.flickr.csrf.csrfExpiresAt=r+t.config.flickr.csrf.fetch_interval,this.drainQueue()},t.CsrfUpdater.prototype.pushToQueue=function(t){this._tasks.push(t)},t.CsrfUpdater.prototype.drainQueue=function(){for(;this._tasks.length;)this._tasks.shift().resolve()},t.CsrfUpdater.prototype.hasQueuedTasks=function(){return!!this._tasks.length},t.CsrfUpdater.prototype.scheduleFutureFetch=function(){t.config.flickr.csrf.token&&(this._timerFutureFetch=setTimeout(this.fetch.bind(this),1e3*t.config.flickr.csrf.fetch_interval))},t.CsrfUpdater.prototype.scheduleRetry=function(e){var r=this,s=this._fetchRuns>4?1:Math.pow(2,(this._fetchRuns||1)-1)/10,i=t.config.flickr.csrf.retry_interval*s;clearTimeout(this._timerRetry),this._timerRetry=setTimeout(function(){r._timerRetry=null,r.fetch(e)},1e3*i)},t.CsrfUpdater.prototype.fetch=function(r){var s=this,i=s.hasQueuedTasks();if(clearTimeout(this._timerFutureFetch),YUI.Env.isServer){if(!r&&(r=new t.Promise(function(t,e){this.resolve=t,this.reject=e}),this.pushToQueue(r),i))return r;this._fetchRuns||(this._fetchRuns=0),this._fetchRuns++,this.flickrAPI.fetchCsrf().then(function(t){var i=t.token;if(!t.token)return e.error("Failed to fetch csrf token",t),void s.scheduleRetry(r);e.log("Received new csrf token",t),s._fetchRuns=0,s.store(i),s.scheduleFutureFetch()},function(t){e.error("Failed to fetch csrf token",{err:t}),s.scheduleRetry(r)})}else t.ClientApp&&t.ClientApp.disableClientNav();return r}},"@VERSION@",{requires:["client-app"]});YUI.add("hermes-template-photo-page-scrappy",function(e,t){var a=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,t,a,l,o){var n=null!=t?t:{},u=a.helperMissing,r=e.escapeExpression;return r((a.outlet||t&&t.outlet||u).call(n,null!=t?t["global-nav-view"]:t,{name:"outlet",hash:{},data:o}))+"\n"+r((a.outlet||t&&t.outlet||u).call(n,null!=t?t["photo-well-view"]:t,{name:"outlet",hash:{},data:o}))+"\n"+r((a.outlet||t&&t.outlet||u).call(n,null!=t?t["sub-photo-view"]:t,{name:"outlet",hash:{},data:o}))+"\n"+r((a.outlet||t&&t.outlet||u).call(n,null!=t?t["signup-footer-view"]:t,{name:"outlet",hash:{},data:o}))+"\n"+r((a.outlet||t&&t.outlet||u).call(n,null!=t?t["footer-full-view"]:t,{name:"outlet",hash:{},data:o}))+"\n"},useData:!0}),l={};e.Array.each([],function(t){var a=e.Template.get("hermes/"+t);a&&(l[t]=a)}),e.Template.register("hermes/photo-page-scrappy",function(t,o){return o=o||{},o.partials=o.partials?e.merge(l,o.partials):l,a(t,o)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("signin-helper",function(e){function n(n,o){e.FlickrStorage.store(n,o)}function o(n,o){var i,t;o&&o.withPopup?(i=e.config.win.open(r(o),"_blank","height=650,resizable=1,scrollbars=1,location=yes"),t=setInterval(function(){i.closed&&(clearInterval(t),window.location.reload())},1e3)):e.config.win.location=r(o)}function r(n){(n=n||{}).closeWhenDone&&(n.postLoginUrl=e.url("/photo_grease_postlogin.gne",{protocol:!1}));var o=n.postLoginUrl||e.config.win.location.href;return(n.url||e.url("/signin/",{protocol:!1}))+"?redir="+encodeURIComponent(o)}function i(n,o){var r=(o=o||{}).postLoginUrl||e.config.win.location.href,i=o.url||e.url("/signup/",{protocol:!1});e.config.win.location=i+"?redir="+encodeURIComponent(r)}e.FlickrStorage={_storageKey:"flickrStorage",store:function(n,o){try{var r=[];e.StorageHelper.hasEntries(this._storageKey)&&(r=this.retrieve()),r.push({key:n,value:o}),e.StorageHelper.setItem(this._storageKey,JSON.stringify(r))}catch(e){}},retrieve:function(){var n={};try{n=JSON.parse(e.StorageHelper.getItem(this._storageKey))}catch(e){}return n},remove:function(){try{e.StorageHelper.remove(this._storageKey)}catch(e){}},hasEntries:function(){return e.StorageHelper.hasEntries(this._storageKey)}},e.SigninHelper={savePreLoginAction:n,addPendingFave:function(e,r){n("fave",e),o(0,r)},addPendingComment:function(e,n){o(0,n)},addPendingShare:function(e,r){n("share",e),o(0,r)},addPendingFollow:function(e,r){n("follow",e),o(0,r)},addPendingJoinGroup:function(e,r){n("joingroup",e),o(0,r)},addPendingDownload:function(e,r){n("download",e),o(0,r)},checkPendingQueue:function(n){var o,r,i=[];if(n){if(e.FlickrStorage.hasEntries()){o=e.FlickrStorage.retrieve();for(r in o)(function(e,n){var o=n.key,r=n.value;switch(o){case"fave":return(function(e,n){var o=n.id;e.getModelRegistry("photo-engagement-models").then(function(e){var n=e.proxy(o);n.registry.addAsFave(o)&&n.remoteUpdate()})})(e,r),!0;case"share":return!1}})(n,o[r])||i.push(o[r])}return e.FlickrStorage.remove(),i}},_redirectToSignin:o,_redirectToSignUp:i,_getSigninUrl:r,signUpPendingFave:function(e,o){n("fave",e),i(0,o)},signUpPendingComment:function(e,n){i(0,n)},signUpPendingFollow:function(e,o){n("follow",e),i(0,o)},signUpPendingJoinGroup:function(e,o){n("joingroup",e),i(0,o)},signUpPendingDownload:function(e,o){n("download",e),i(0,o)}}},"@VERSION@",{requires:["url","storage-helper"]});